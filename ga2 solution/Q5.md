## Step 1: Sabse Pehle - Problem Samjho
**Kya karna hai?**  
Humko Vercel naam ki ek platform pe ek website banani hai jo:  
* POST requests accept karegi
* JSON data legi
* Calculations karegi
* Result wapas bhejegi  
**Example:**
Jaise koi bhejta hai: {"regions": ["india", "usa"], "threshold_ms": 200}
To hum calculate karenge:
* India ka average latency kya hai?
* USA ka 95% latency kya hai?
* Kitni baar threshold exceed hua?
## Step 2: Project Folder Banayein
**Kya karna hai:** 

Ek folder structure banani hai jaisa ki Vercel expect karta hai. 

**Kaise karna hai:**
1. Apne computer pe kahi bhi ek new folder banayein
1. Folder ka naam rakhein: vercel-latency-api
1. Iske andar ek aur folder banayein: api
**Yeh aisa dikhna chahiye:**
```text
vercel-latency-api/
└── api/
```
# Step 3: Data File Download Karein
**Kya karna hai:**
Exam se data file download karni hai aur sahi jagah rakhni hai.

**Kaise karna hai:**
1. Exam page se q-vercel-latency.json file download karein
1. Is file ko api folder ke andar paste karein  
**Ab aisa dikhna chahiye:**
```text
vercel-latency-api/
└── api/
    └── q-vercel-latency.json
```
**Important:** Yeh file humare data ka source hai. Ismein saare regions ka latency aur uptime data hai.

# Step 4: Python Code File Banayein
**Kya karna hai:**  
api folder ke andar index.py naam ki file banani hai jismein humara server code hoga.  
**Kaise karna hai:**
1. api folder ke andar right-click karein
1. "New Text Document" banayein
1. Uska naam index.py rakhein
1. Ismein yeh code type karein ya copy-paste karein:
```python
from fastapi import FastAPI, Request
from fastapi.middleware.cors import CORSMiddleware
import pandas as pd
import numpy as np
from pathlib import Path

app = FastAPI()

# CORS enable karna - sabhi websites se request allow karega
app.add_middleware(
    CORSMiddleware,
    allow_origins=["*"],
    allow_credentials=True,
    allow_methods=["*"],
    allow_headers=["*"],
)

# Data file load karna
DATA_FILE = Path(__file__).parent / "q-vercel-latency.json"
df = pd.read_json(DATA_FILE)

@app.get("/")
async def root():
    return {"message": "Vercel Latency Analytics API is running."}

@app.post("/api/")
async def get_latency_stats(request: Request):
    # Client se data receive karna
    payload = await request.json()
    regions_to_process = payload.get("regions", [])
    threshold = payload.get("threshold_ms", 200)

    results = []

    # Har region ke liye calculations karna
    for region in regions_to_process:
        region_df = df[df["region"] == region]

        if not region_df.empty:
            # Average latency calculate
            avg_latency = round(region_df["latency_ms"].mean(), 2)
            
            # 95th percentile latency
            p95_latency = round(np.percentile(region_df["latency_ms"], 95), 2)
            
            # Average uptime
            avg_uptime = round(region_df["uptime_pct"].mean(), 3)
            
            # Breaches count (threshold se jyada latency wale records)
            breaches = int(region_df[region_df["latency_ms"] > threshold].shape[0])

            results.append({
                "region": region,
                "avg_latency": avg_latency,
                "p95_latency": p95_latency,
                "avg_uptime": avg_uptime,
                "breaches": breaches,
            })

    return {"regions": results}
```
**Explaination**  
**Part 1 - Import Statements:**
```python
from fastapi import FastAPI, Request
```
* **FastAPI:** Ek modern web framework hai jo APIs banane ke liye use hota hai
* **Request:** Client se aaye hue request ko handle karne ke liye
```python
from fastapi.middleware.cors import CORSMiddleware
```
* **CORS:** "Cross-Origin Resource Sharing" - Agar koi different website se humari API use karega to browser block karega. CORS uska solution hai.
```python
import pandas as pd
import numpy as np
```
* **Pandas:** Excel jaisa hai - tables (DataFrames) ko handle karta hai
* **Numpy:** Mathematical calculations ke liye
```python
from pathlib import Path
```
* **Path:** File paths ko easily handle karne ke liye  
**Part 2 - App Setup:**
  ```python
  app = FastAPI()
  ```
* Jaise restaurant mein manager hota hai, waise hi app humara web server manager hai
  
**Part 3 - CORS Setup:**
```python
app.add_middleware(
    CORSMiddleware,
    allow_origins=["*"],  # Sabhi websites ko allow
    allow_credentials=True,
    allow_methods=["*"],  # Sabhi HTTP methods allow
    allow_headers=["*"],  # Sabhi headers allow
)
```
* **allow_origins=["*"]:** Koi bhi website humari API use kar sakti hai
* Agar allow_origins=["*"] na hota to:
  * https://example.com se https://our-api.vercel.app call nahi kar sakte
  * Browser error dega: "CORS policy blocked"

**Part 4 - Data Load:**
```python
DATA_FILE = Path(__file__).parent / "q-vercel-latency.json"
df = pd.read_json(DATA_FILE)
```
* **__file__:** Current file (index.py) ka path
* **.parent:** Parent folder (api folder)
* **/ "q-vercel-latency.json":** File ka naam
* **pd.read_json():** JSON file ko pandas DataFrame mein convert karta hai
  * what is panda data frame?
    ```python
    import pandas as pd

# From dictionary
data = {
    'Name': ['Alice', 'Bob', 'Charlie'],
    'Age': [25, 30, 35],
    'City': ['New York', 'London', 'Tokyo']
}
df = pd.DataFrame(data)
print(df)
```
```text
      Name  Age      City
0    Alice   25  New York
1      Bob   30    London
2  Charlie   35     Tokyo
```
**Part 5 - GET Route:**
```python
@app.get("/")
async def root():
    return {"message": "Vercel Latency Analytics API is running."}
```
* **@app.get("/"):** Yeh decorator hai - batata hai ki agar koi "/" (root) pe GET request kare to yeh function run ho
* **Browser mein `https://our-api.vercel.app/` open karoge to yeh message dikhega
**Part 6 - POST Route (Main Logic):**
```python
@app.post("/api/")
async def get_latency_stats(request: Request):
    payload = await request.json()
```
**Client Request Example:**
```python
{
  "regions": ["india", "usa"],
  "threshold_ms": 180
}
```
**Code Breakdown:**
* `@app.post("/api/")`: POST requests handle karega /api/ endpoint pe
* `request`: Request: Client ka complete request
* `await request.json()`: Request ka JSON body read karta hai
* `payload.get("regions", [])`: "regions" key ki value lega, agar nahi hai to empty list
* `payload.get("threshold_ms", 200)`: "threshold_ms" ki value lega, agar nahi hai to default 200
**Part 7 - Calculations:**
```python
for region in regions_to_process:
    region_df = df[df["region"] == region]
```
* **Filtering:** Pure data mein se sirf specific region ke records nikal rahe hain
* Example: Agar regions = ["india"] to sirf India ke records filter honge
```python
avg_latency = round(region_df["latency_ms"].mean(), 2)
```
* **Mean Calculation:** Saare latency values ka average nikal rahe hain
* **Example:** India ke 3 records: [150, 200, 100]
* Average = (150 + 200 + 100) / 3 = 150
* round(150, 2) = 150.00
```python
p95_latency = round(np.percentile(region_df["latency_ms"], 95), 2)
```
* **95th Percentile:** 95% requests is value se fast hain, 5% slow
* **Example:** Values = [100, 150, 200, 250, 300]
* 95th percentile = ~290 (95% requests 290ms se fast hain)
```python
avg_uptime = round(region_df["uptime_pct"].mean(), 3)
```
* **Uptime Average:** Saare uptime percentages ka average
```python
breaches = int(region_df[region_df["latency_ms"] > threshold].shape[0])
```
* **Breach Count:** Kitne records threshold se jyada hain
* **Example:** threshold = 180, records = [150, 200, 100, 250]
* 200 > 180 ✅, 250 > 180 ✅
* Breaches = 2

**Final Output:**
```python
return {"regions": results}
```

**Response Example:**
```json
{
  "regions": [
    {
      "region": "india",
      "avg_latency": 150.25,
      "p95_latency": 210.50,
      "avg_uptime": 99.850,
      "breaches": 45
    }
  ]
}
```
# Step 5: Requirements.txt File Banayein
**Kya karna hai:**  
Ek requirements.txt file banani hai jo batayegi ki humare project ko kaun-kaun si Python libraries chahiye.  
**Kaise karna hai:**  
1. `vercel-latency-api` folder ke andar (api folder ke bahar) right-click karein
1. "New Text Document" banayein
1. Uska naam `requirements.txt`rakhein
1. Ismein yeh 4 lines type karein:
```text
fastapi==0.104.1
uvicorn==0.24.0
pandas==2.1.3
numpy==1.25.2
```
**Detailed Explanation:**  
**Kyun jaroori hai requirements.txt?**  
* Jab Vercel pe deploy karenge to Vercel ko pata chalega ki kaunsi libraries install karni hain
* Jaise restaurant mein menu hota hai, waise hi requirements.txt humara "libraries ka menu" hai  
**Har Library ka Kaam:**  
1. fastapi==0.104.1
  * **Kyun?:** Humara web server banane ke liye
  * **Kaam:** API endpoints create karne ke liye, requests handle karne ke liye
  * **Bina iske:** Koi bhi web request handle nahi kar payenge
1. uvicorn==0.24.0
  * **Kyun?:** FastAPI ko run karne ke liye
  * **Kaam:** Ek "ASGI server" hai jo humare code ko actually run karta hai
  * **Example:** Jaise car ko chalane ke liye engine chahiye, waise hi FastAPI ko chalane ke liye uvicorn chahiye
1. pandas==2.1.3
  * **Kyun?:** Data analysis ke liye
  * **Kaam:**
    * JSON file read karna
    * Data filter karna (specific regions ke liye)
    * Calculations karna (average, mean, etc.)

  * **Bina iske:** Hum data file nahi read kar payenge, calculations nahi kar payenge
1. numpy==1.25.2
  * **Kyun?:** Advanced mathematical calculations ke liye
  * **Kaam:** 95th percentile calculate karne ke liye
  * **Specific Function:** np.percentile() jo humare code mein use ho raha hai
**Version Numbers kyun?**
* ==0.104.1 specific version batata hai
* **Kyun?:** Taaki future mein koi breaking change aaye to humara code break na ho
* **Example:** Agar pandas 3.0 aaya aur usme koi change aaya, to humara code 2.1.3
version pe hi run karega  
**File Location:**  
```text
vercel-latency-api/
├── api/
│   ├── index.py
│   └── q-vercel-latency.json
└── requirements.txt    ← YEHI PE BANAYEIN
```
# Step 6: Vercel.json File Banayein
**Kya karna hai:**
Ek vercel.json file banani hai jo Vercel ko batayegi ki humara project kaise build aur run karna hai.  
**Kaise karna hai:**  
1. vercel-latency-api folder ke andar (api folder ke bahar) right-click karein
1. "New Text Document" banayein
1. Uska naam vercel.json rakhein
1. Ismein yeh JSON code copy-paste karein:
```json
{
  "builds": [{
    "src": "api/index.py",
    "use": "@vercel/python"
  }],
  "routes": [{
    "src": "/(.*)",
    "dest": "api/index.py"
  }]
}
```  
**Detailed Explanation:**  
**Kyun jaroori hai vercel.json?**  
* Vercel ko instructions dene ke liye ki humara project kaise handle karna hai
* Jaise kisi machine ko manual chahiye hota hai, waise hi Vercel ko yeh file chahiye  
**Part 1 - Builds Section:**
```json
"builds": [{
  "src": "api/index.py",
  "use": "@vercel/python"
}]
```  
**Breakdown:**
* `src`: `"api/index.py"`
    * Source file batata hai - kahan se code start karna hai
    * Humara main code api/index.py mein hai
* `use`: `"@vercel/python"`
    * Builder batata hai - kaunsa tool use karna hai
    * `@vercel/python` Vercel ka official Python builder hai
    * Yeh automatically:
        * Python environment setup karega
        * requirements.txt se libraries install karega
        * Humara code deploy karega    
     
**Part 2 - Routes Section:**   
```json
"routes": [{
  "src": "/(.*)",
  "dest": "api/index.py"
}]
```  
***Breakdown:**  
* `src`: `"/(.*)"`
    *Source route pattern batata hai
    * `/(.*)` means "sabhi URLs" (all URLs)
    * Example: /, /api/, /test, /anything
* `dest` : `"api/index.py"`
    * Destination batata hai - kahan bhejna hai request
    * Har request api/index.py pe jayegi
    * FastAPI framework handle karega ki kaunsa function run karna hai  
**Real Example Kaise Kaam Karega:**  
1. User request karega:
```text
POST https://our-app.vercel.app/api/
```
1. Vercel routes check karega:
* URL: `/api/` matches `/(.*)` pattern
* Request ko `api/index.py` pe forward karega
1. FastAPI handle karega:
* `@app.post("/api/")` decorator match karega
* `get_latency_stats()` function run hoga  
**Complete File Structure Ab:**
```text
vercel-latency-api/
├── api/
│   ├── index.py
│   └── q-vercel-latency.json
├── requirements.txt
└── vercel.json    ← NAYI FILE
```
**Common Mistakes Avoid Karein:**  
* File ka naam `vercel.json` hi hona chahiye (capital V nahi)
* JSON syntax sahi honi chahiye (commas, brackets)
* File project ke root folder mein honi chahiye
# Step 7: Local Testing Karein (Deploy se Pehle)
**Kya karna hai:**  
Apne computer pe hi pehle test karna hai ki sab kuch sahi kaam kar raha hai.
**Kaise karna hai:**  
**Part A - Dependencies Install Karein:**  
1. Command Prompt/Terminal open karein
1. Project folder mein jayein:
```bash
cd path/to/vercel-latency-api
```
1. Virtual environment banayein (Optional but recommended):
```bash
python -m venv venv
```
1. Virtual environment activate karein:
* Windows:
```bash
venv\Scripts\activate
```
* Mac/Linux:
```bash
source venv/bin/activate
```
1. Libraries install karein:
```bash
pip install fastapi uvicorn pandas numpy
``` 
**Detailed Explanation of Each Step:**  
**Virtual Environment kyun?**   
* Jaise ek room alag hota hai, virtual environment alag space banata hai
* System ke dusre projects affect nahi honge
* Specific versions maintain karne mein help karta hai  
**Libraries Installation:**  
* pip install command Python packages download karta hai
* Har library internet se download hogi aur install hogi
* Installation complete hone par "Successfully installed" message aayega  
**Part B - Server Run Karein:**  
``bash
cd api
uvicorn index:app --reload
```  
**Breakdown:**  
* `cd api`: api folder mein jana
* `uvicorn`: ASGI server jo FastAPI ko run karega
* `index`:`app`:
    * `index` = `index.py` file
    * `app` = `FastAPI()` object jo humne banaya hai
* `--reload`: Development mode `- code` change karte hi automatically restart  
**Success Message:**  
```text
INFO:     Uvicorn running on http://127.0.0.1:8000 (Press CTRL+C to quit)
```
Yeh batata hai ki server localhost:8000 pe run ho raha hai  
**Part C - Test Karein Browser se:**  
1. Browser open karein
1. Address bar mein daalein: http://127.0.0.1:8000/
1. Output dikhna chahiye:
```json
{"message":"Vercel Latency Analytics API is running."}
```  
**Part D - POST Request Test Karein:**  
**Option 1 - Command Line se (curl):**  
```bash
curl -X POST http://127.0.0.1:8000/api/ \
-H "Content-Type: application/json" \
-d '{"regions": ["emea", "apac"], "threshold_ms": 180}'
```  
**Option 2 - Postman se (Easier):**  
1. Postman download karein
1. New request banayein:
    * Method: POST
    * URL: `http://127.0.0.1:8000/api/`
    * Body → raw → JSON:
```json
{
  "regions": ["emea", "apac"],
  "threshold_ms": 180
}
```  
**Expected Response:**  
```json
{
  "regions": [
    {
      "region": "emea",
      "avg_latency": 150.25,
      "p95_latency": 210.50,
      "avg_uptime": 99.850,
      "breaches": 45
    },
    {
      "region": "apac",
      "avg_latency": 165.75,
      "p95_latency": 225.30,
      "avg_uptime": 99.920,
      "breaches": 32
    }
  ]
}
```  
**Common Errors aur Solutions:**  
1. ModuleNotFoundError:
    * Solution: `pip install` phir se karein
1. FileNotFoundError (q-vercel-latency.json):
    * Solution: Check karein file sahi location mein hai
1. Address already in use:
    * Solution: Different port use karein: uvicorn index:app --reload --port 8001  
**Testing Complete hone ke Signs:**  
✅ Server start ho gaya
✅ GET request pe message dikh raha hai
✅ POST request pe calculations result aa raha hai
✅ Koi error nahi aa raha











  







